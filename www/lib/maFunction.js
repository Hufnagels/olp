(function(g,e,c){var k={$passwordSubmit:document.getElementById("submit")||"",$upload:document.getElementById("upload")||"",$profilePicture:document.getElementById("profilePicture")||"",statisticHolder:document.getElementById("statisticHolder")||""};var n={};var d={url:"",data:n,responseType:"json"};var b=160;var l=160;var h={init:function(){this.attachEditable();this.attachSpecialEditable()},attachEditable:function(){e("#detailsForm").find("a").editable({success:function(o,p){sendMessage("alert-"+o.type,o.message)}});e("#cv, #description").editable({success:function(o,p){sendMessage("alert-"+o.type,o.message)}})},attachSpecialEditable:function(){e("#gender").editable({source:[{value:1,text:"Male"},{value:2,text:"Female"}],success:function(o,p){sendMessage("alert-"+o.type,o.message)}});e("#birth").editable({success:function(o,p){sendMessage("alert-"+o.type,o.message)}});e("#language").editable({source:[{value:"hungarian",text:"hungarian"},{value:"english",text:"english"},{value:"german",text:"german"},{value:"italian",text:"italian"},{value:"spanish",text:"spanish"}],success:function(o,p){sendMessage("alert-"+o.type,o.message)}});e(".myPass").editable({emptytext:"Change here",send:"never"})},submitPassword:function(p){p.preventDefault();if(e("#pwd").attr("data-pwd")!==e("#pwd2").attr("data-pwd")){e(".help-block").html("Passwords must be the same").addClass("alert alert-error").show();return false}if(e("#pwd").attr("data-pwd").length<5){e(".help-block").html("Passwords must be min 5 chars").addClass("alert alert-error").show();return false}e(".help-block").hide();n={};n.action="changePassword";n.pk=e("#pwd").attr("data-pk");n.value=e("#pwd").attr("data-pwd");d.url="/crawl?/process/myaccount/handelmyaccount/";d.data=n;var o=getJsonData(d)}};var f={userid:0,init:function(){userid=document.getElementById("userid").value;this.getTrainingStat()},getTrainingStat:function(){j=[];m={};m.form=e(k.form).serializeArray();m.userid=userid;d.url="/crawl?/process/statistic/handeluserstat/";d.data=m;var t=getJsonData(d);if(!t){return false}j.result=[];var s=[],p=[];for(var u in t.result){s.push(u)}for(var v=0,u;u=t.main[v];v++){p.push(u.title)}for(var v=0,u;u=s[v];v++){t.result[u].title=p[v];j.result.push(t.result[u])}this.publishSummarized(j);return false},publishSummarized:function(o){e(k.statisticHolder).html(tmpl("tmpl-statpanel2",o))}};g.init=function(){e.fn.editable.defaults.mode="inline";e.fn.editable.defaults.url="/crawl?/process/myaccount/handelmyaccount/";e.fn.editable.defaults.dataType="json";e.fn.editable.defaults.emptytext="Please, fill this";e.fn.editable.defaults.params=function(o){o.action="changeData";return o};h.init();f.init();addEventO(k.$passwordSubmit,"click",h.submitPassword,true,_eventHandlers);addEventO(k.$upload,"change",function(o){i(o,k.$profilePicture)},false,_eventHandlers);e(k.$profilePicture).on("click",function(){e(k.$upload).trigger("click")});e(".accordion").on("show",function(o){e(o.target).prev(".accordion-heading").find(".accordion-toggle").addClass("active");e(o.target).prev(".accordion-heading").find(".accordion-toggle i").removeClass("icon-plus");e(o.target).prev(".accordion-heading").find(".accordion-toggle i").addClass("icon-minus")});e(".accordion").on("hide",function(o){e(this).find(".accordion-toggle").not(e(o.target)).removeClass("active");e(this).find(".accordion-toggle i").not(e(o.target)).removeClass("icon-minus");e(this).find(".accordion-toggle i").not(e(o.target)).addClass("icon-plus")})};function a(p,q){var s=p.target.files;for(var r=0,t;t=s[r];r++){if(!t.type.match("image.*")){continue}var o=new FileReader();o.onload=(function(u){return function(v){q.src=v.target.result}})(t);o.readAsDataURL(t)}}function i(p,r){var q=p.target.files[0];var o=new FileReader();o.onloadend=function(){var s=new Image();s.src=o.result;s.onload=function(){var u=resizeCrop(this,b,l,-5).toDataURL("image/jpg",90);e(r).attr("src",u);n.action="changeData";n.pk=e(r).attr("data-pk");n.name=e(r).attr("id");n.value=u;d.url="/crawl?/process/myaccount/handelmyaccount/";d.data=n;var t=getJsonData(d)}};o.readAsDataURL(q)}}(window.myAccount=window.myAccount||{},jQuery));
(function(e){"use strict";var t={errors:[],minChar:8,errorMessages:{password_to_short:"The Password is too short",same_as_username:"Your password cannot be the same as your username"},scores:[17,26,40,50],verdicts:["Weak","Normal","Medium","Strong","Very Strong"],showVerdicts:true,raisePower:1.4,usernameField:"#username",onLoad:undefined,onKeyUp:undefined,placeholder:undefined,viewports:{progress:undefined,verdict:undefined,errors:undefined},ruleScores:{wordNotEmail:-100,wordLength:-100,wordSimilarToUsername:-100,wordLowercase:1,wordUppercase:3,wordOneNumber:3,wordThreeNumbers:5,wordOneSpecialChar:3,wordTwoSpecialChar:5,wordUpperLowerCombo:2,wordLetterNumberCombo:2,wordLetterNumberCharCombo:2},rules:{wordNotEmail:true,wordLength:true,wordSimilarToUsername:true,wordLowercase:true,wordUppercase:true,wordOneNumber:true,wordThreeNumbers:true,wordOneSpecialChar:true,wordTwoSpecialChar:true,wordUpperLowerCombo:true,wordLetterNumberCombo:true,wordLetterNumberCharCombo:true},validationRules:{wordNotEmail:function(e,t,n){return t.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)&&n},wordLength:function(e,t,n){var r=t.length,i=Math.pow(r,e.raisePower);if(r<e.minChar){i=i+n;e.errors.push(e.errorMessages.password_to_short)}return i},wordSimilarToUsername:function(t,n,r){var i=e(t.usernameField).val();if(i&&n.toLowerCase().match(i.toLowerCase())){t.errors.push(t.errorMessages.same_as_username);return r}return true},wordLowercase:function(e,t,n){return t.match(/[a-z]/)&&n},wordUppercase:function(e,t,n){return t.match(/[A-Z]/)&&n},wordOneNumber:function(e,t,n){return t.match(/\d+/)&&n},wordThreeNumbers:function(e,t,n){return t.match(/(.*[0-9].*[0-9].*[0-9])/)&&n},wordOneSpecialChar:function(e,t,n){return t.match(/.[!,@,#,$,%,\^,&,*,?,_,~]/)&&n},wordTwoSpecialChar:function(e,t,n){return t.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&n},wordUpperLowerCombo:function(e,t,n){return t.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&n},wordLetterNumberCombo:function(e,t,n){return t.match(/([a-zA-Z])/)&&t.match(/([0-9])/)&&n},wordLetterNumberCharCombo:function(e,t,n){return t.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&n}}},n=function(t,n){var r=t.data("pwstrength"),i=r.progressbar,s;if(r.showVerdicts){if(r.viewports.verdict){s=e(r.viewports.verdict).find(".password-verdict")}else{s=t.parent().find(".password-verdict");if(s.length===0){s=e('<span class="password-verdict"></span>');s.insertAfter(t)}}}if(n<r.scores[0]){i.addClass("progress-danger").removeClass("progress-warning").removeClass("progress-success");i.find(".bar").css("width","5%");if(r.showVerdicts){s.text(r.verdicts[0])}}else if(n>=r.scores[0]&&n<r.scores[1]){i.addClass("progress-danger").removeClass("progress-warning").removeClass("progress-success");i.find(".bar").css("width","25%");if(r.showVerdicts){s.text(r.verdicts[1])}}else if(n>=r.scores[1]&&n<r.scores[2]){i.addClass("progress-warning").removeClass("progress-danger").removeClass("progress-success");i.find(".bar").css("width","50%");if(r.showVerdicts){s.text(r.verdicts[2])}}else if(n>=r.scores[2]&&n<r.scores[3]){i.addClass("progress-warning").removeClass("progress-danger").removeClass("progress-success");i.find(".bar").css("width","75%");if(r.showVerdicts){s.text(r.verdicts[3])}}else if(n>=r.scores[3]){i.addClass("progress-success").removeClass("progress-warning").removeClass("progress-danger");i.find(".bar").css("width","100%");if(r.showVerdicts){s.text(r.verdicts[4])}}},r=function(t){var r=this,i=t.val(),s=0,o=t.data("pwstrength");e.each(o.rules,function(e,t){if(t===true){var n=o.ruleScores[e],r=o.validationRules[e](o,i,n);if(r){s+=r}}});n(t,s);return s},i=function(){return'<div class="progress"><div class="bar"></div></div>'},s={init:function(n){var s=this,o=e.extend(t,n);return this.each(function(t,n){var u=e(n),a,f;u.data("pwstrength",o);u.on("keyup",function(t){var n=u.data("pwstrength");n.errors=[];r.call(s,u);if(e.isFunction(n.onKeyUp)){n.onKeyUp(t)}});a=e(i());if(o.viewports.progress){e(o.viewports.progress).append(a)}else{a.insertAfter(u)}a.find(".bar").css("width","0%");u.data("pwstrength").progressbar=a;if(o.showVerdicts){f=e('<span class="password-verdict">'+o.verdicts[0]+"</span>");if(o.viewports.verdict){e(o.viewports.verdict).append(f)}else{f.insertAfter(u)}}if(e.isFunction(o.onLoad)){o.onLoad()}})},destroy:function(){this.each(function(t,n){var r=e(n);r.parent().find("span.password-verdict").remove();r.parent().find("div.progress").remove();r.parent().find("ul.error-list").remove();r.removeData("pwstrength")})},forceUpdate:function(){var t=this;this.each(function(n,i){var s=e(i),o=s.data("pwstrength");o.errors=[];r.call(t,s)})},outputErrorList:function(){this.each(function(t,n){var r='<ul class="error-list">',i=e(n),s=i.data("pwstrength").errors,o=i.data("pwstrength").viewports,u;i.parent().find("ul.error-list").remove();if(s.length>0){e.each(s,function(e,t){r+="<li>"+t+"</li>"});r+="</ul>";if(o.errors){e(o.errors).html(r)}else{r=e(r);u=i.parent().find("span.password-verdict");if(u.length>0){n=u}r.insertAfter(n)}}})},addRule:function(t,n,r,i){this.each(function(s,o){var u=e(o).data("pwstrength");u.rules[t]=i;u.ruleScores[t]=r;u.validationRules[t]=n})},changeScore:function(t,n){this.each(function(r,i){e(i).data("pwstrength").ruleScores[t]=n})},ruleActive:function(t,n){this.each(function(r,i){e(i).data("pwstrength").rules[t]=n})}};e.fn.pwstrength=function(t){var n;if(s[t]){n=s[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){n=s.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.pwstrength")}return n}})(jQuery)